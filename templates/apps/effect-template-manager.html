<div class="effect-template-manager">
    <header class="template-manager-header">
        <h1>Effect Template Manager</h1>
        <div class="template-actions">
            {{#if isGM}}
                <button class="import-templates">
                    <i class="fas fa-upload"></i> Import
                </button>
                <button class="export-templates">
                    <i class="fas fa-download"></i> Export
                </button>
            {{/if}}
        </div>
    </header>

    <nav class="template-tabs">
        {{#each categories}}
            <button class="template-tab-button {{#if @first}}active{{/if}}" data-template-tab="{{key}}">
                <i class="{{icon}}"></i>
                <span>{{label}}</span>
                <span class="count">({{count}})</span>
            </button>
        {{/each}}
    </nav>

    <main class="template-content">
        <!-- Combat Templates -->
        <section class="template-tab-content active" data-template-tab-content="combat">
            <header class="category-header">
                <h2>Combat Templates</h2>
                {{#if isGM}}
                    <button class="create-template" data-category="combat">
                        <i class="fas fa-plus"></i> Create Template
                    </button>
                {{/if}}
            </header>

            <div class="template-list">
                {{#if templates.combat}}
                    {{#each templates.combat}}
                        <div class="template-card" data-template-id="{{id}}">
                            <div class="template-icon">
                                <img src="{{icon}}" alt="{{name}}" />
                            </div>
                            <div class="template-info">
                                <h3>{{name}}</h3>
                                <p>{{description}}</p>
                                <div class="template-effects">
                                    {{#if changes}}
                                        <span class="effect-count">{{changes.length}} effect(s)</span>
                                    {{/if}}
                                </div>
                            </div>
                            {{#if ../isGM}}
                                <div class="template-actions">
                                    <button class="edit-template" data-template-id="{{id}}" data-category="combat" title="Edit Template">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="duplicate-template" data-template-id="{{id}}" data-category="combat" title="Duplicate Template">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="delete-template" data-template-id="{{id}}" data-category="combat" title="Delete Template">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            {{/if}}
                        </div>
                    {{/each}}
                {{else}}
                    <div class="no-templates">
                        <p>No combat templates found.</p>
                        {{#if isGM}}
                            <p>Click "Create Template" to add your first template.</p>
                        {{/if}}
                    </div>
                {{/if}}
            </div>
        </section>

        <!-- Physical Templates -->
        <section class="template-tab-content" data-template-tab-content="physical">
            <header class="category-header">
                <h2>Physical Templates</h2>
                {{#if isGM}}
                    <button class="create-template" data-category="physical">
                        <i class="fas fa-plus"></i> Create Template
                    </button>
                {{/if}}
            </header>

            <div class="template-list">
                {{#if templates.physical}}
                    {{#each templates.physical}}
                        <div class="template-card" data-template-id="{{id}}">
                            <div class="template-icon">
                                <img src="{{icon}}" alt="{{name}}" />
                            </div>
                            <div class="template-info">
                                <h3>{{name}}</h3>
                                <p>{{description}}</p>
                                <div class="template-effects">
                                    {{#if changes}}
                                        <span class="effect-count">{{changes.length}} effect(s)</span>
                                    {{/if}}
                                </div>
                            </div>
                            {{#if ../isGM}}
                                <div class="template-actions">
                                    <button class="edit-template" data-template-id="{{id}}" data-category="physical" title="Edit Template">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="duplicate-template" data-template-id="{{id}}" data-category="physical" title="Duplicate Template">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="delete-template" data-template-id="{{id}}" data-category="physical" title="Delete Template">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            {{/if}}
                        </div>
                    {{/each}}
                {{else}}
                    <div class="no-templates">
                        <p>No physical templates found.</p>
                        {{#if isGM}}
                            <p>Click "Create Template" to add your first template.</p>
                        {{/if}}
                    </div>
                {{/if}}
            </div>
        </section>

        <!-- Environmental Templates -->
        <section class="template-tab-content" data-template-tab-content="environmental">
            <header class="category-header">
                <h2>Environmental Templates</h2>
                {{#if isGM}}
                    <button class="create-template" data-category="environmental">
                        <i class="fas fa-plus"></i> Create Template
                    </button>
                {{/if}}
            </header>

            <div class="template-list">
                {{#if templates.environmental}}
                    {{#each templates.environmental}}
                        <div class="template-card" data-template-id="{{id}}">
                            <div class="template-icon">
                                <img src="{{icon}}" alt="{{name}}" />
                            </div>
                            <div class="template-info">
                                <h3>{{name}}</h3>
                                <p>{{description}}</p>
                                <div class="template-effects">
                                    {{#if changes}}
                                        <span class="effect-count">{{changes.length}} effect(s)</span>
                                    {{/if}}
                                </div>
                            </div>
                            {{#if ../isGM}}
                                <div class="template-actions">
                                    <button class="edit-template" data-template-id="{{id}}" data-category="environmental" title="Edit Template">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="duplicate-template" data-template-id="{{id}}" data-category="environmental" title="Duplicate Template">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="delete-template" data-template-id="{{id}}" data-category="environmental" title="Delete Template">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            {{/if}}
                        </div>
                    {{/each}}
                {{else}}
                    <div class="no-templates">
                        <p>No environmental templates found.</p>
                        {{#if isGM}}
                            <p>Click "Create Template" to add your first template.</p>
                        {{/if}}
                    </div>
                {{/if}}
            </div>
        </section>

        <!-- Medical Templates -->
        <section class="template-tab-content" data-template-tab-content="medical">
            <header class="category-header">
                <h2>Medical Templates</h2>
                {{#if isGM}}
                    <button class="create-template" data-category="medical">
                        <i class="fas fa-plus"></i> Create Template
                    </button>
                {{/if}}
            </header>

            <div class="template-list">
                {{#if templates.medical}}
                    {{#each templates.medical}}
                        <div class="template-card" data-template-id="{{id}}">
                            <div class="template-icon">
                                <img src="{{icon}}" alt="{{name}}" />
                            </div>
                            <div class="template-info">
                                <h3>{{name}}</h3>
                                <p>{{description}}</p>
                                <div class="template-effects">
                                    {{#if changes}}
                                        <span class="effect-count">{{changes.length}} effect(s)</span>
                                    {{/if}}
                                </div>
                            </div>
                            {{#if ../isGM}}
                                <div class="template-actions">
                                    <button class="edit-template" data-template-id="{{id}}" data-category="medical" title="Edit Template">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="duplicate-template" data-template-id="{{id}}" data-category="medical" title="Duplicate Template">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="delete-template" data-template-id="{{id}}" data-category="medical" title="Delete Template">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            {{/if}}
                        </div>
                    {{/each}}
                {{else}}
                    <div class="no-templates">
                        <p>No medical templates found.</p>
                        {{#if isGM}}
                            <p>Click "Create Template" to add your first template.</p>
                        {{/if}}
                    </div>
                {{/if}}
            </div>
        </section>

        <!-- Custom Templates -->
        <section class="template-tab-content" data-template-tab-content="custom">
            <header class="category-header">
                <h2>Custom Templates</h2>
                {{#if isGM}}
                    <button class="create-template" data-category="custom">
                        <i class="fas fa-plus"></i> Create Template
                    </button>
                {{/if}}
            </header>

            <div class="template-list">
                {{#if templates.custom}}
                    {{#each templates.custom}}
                        <div class="template-card" data-template-id="{{id}}">
                            <div class="template-icon">
                                <img src="{{icon}}" alt="{{name}}" />
                            </div>
                            <div class="template-info">
                                <h3>{{name}}</h3>
                                <p>{{description}}</p>
                                <div class="template-effects">
                                    {{#if changes}}
                                        <span class="effect-count">{{changes.length}} effect(s)</span>
                                    {{/if}}
                                </div>
                            </div>
                            {{#if ../isGM}}
                                <div class="template-actions">
                                    <button class="edit-template" data-template-id="{{id}}" data-category="custom" title="Edit Template">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="duplicate-template" data-template-id="{{id}}" data-category="custom" title="Duplicate Template">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <button class="delete-template" data-template-id="{{id}}" data-category="custom" title="Delete Template">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            {{/if}}
                        </div>
                    {{/each}}
                {{else}}
                    <div class="no-templates">
                        <p>No custom templates found.</p>
                        {{#if isGM}}
                            <p>Click "Create Template" to add your first template.</p>
                        {{/if}}
                    </div>
                {{/if}}
            </div>
        </section>
    </main>
</div>

<style>
.effect-template-manager {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding: 0;
}

.template-manager-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid #ccc;
    background: #f8f9fa;
}

.template-manager-header h1 {
    margin: 0;
    font-size: 1.5em;
}

.template-actions button {
    margin-left: 10px;
    padding: 8px 12px;
    border: 1px solid #007bff;
    background: #007bff;
    color: white;
    border-radius: 4px;
    cursor: pointer;
}

.template-actions button:hover {
    background: #0056b3;
}

.template-tabs {
    display: flex;
    background: #f8f9fa;
    border-bottom: 1px solid #ccc;
    padding: 0 20px;
}

.template-tab-button {
    background: none;
    border: none;
    padding: 12px 16px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    display: flex;
    align-items: center;
    gap: 8px;
}

.template-tab-button.active {
    border-bottom-color: #007bff;
    background: rgba(0, 123, 255, 0.1);
}

.template-tab-button:hover {
    background: rgba(0, 123, 255, 0.05);
}

.template-tab-button .count {
    background: #6c757d;
    color: white;
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 0.8em;
}

.template-content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}

.template-tab-content {
    display: none;
}

.template-tab-content.active {
    display: block;
}

.category-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.category-header h2 {
    margin: 0;
}

.create-template {
    background: #28a745;
    color: white;
    border: 1px solid #28a745;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
}

.create-template:hover {
    background: #218838;
}

.template-list {
    display: grid;
    gap: 15px;
}

.template-card {
    display: flex;
    align-items: center;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: white;
    transition: box-shadow 0.2s;
}

.template-card:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.template-icon {
    width: 40px;
    height: 40px;
    margin-right: 15px;
    flex-shrink: 0;
}

.template-icon img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

.template-info {
    flex: 1;
}

.template-info h3 {
    margin: 0 0 5px 0;
    font-size: 1.1em;
}

.template-info p {
    margin: 0 0 8px 0;
    color: #6c757d;
    font-size: 0.9em;
}

.template-effects {
    font-size: 0.8em;
    color: #007bff;
}

.template-actions {
    display: flex;
    gap: 5px;
}

.template-actions button {
    background: none;
    border: 1px solid #6c757d;
    padding: 6px 8px;
    border-radius: 4px;
    cursor: pointer;
    color: #6c757d;
}

.template-actions button:hover {
    background: #f8f9fa;
}

.template-actions .edit-template:hover {
    color: #007bff;
    border-color: #007bff;
}

.template-actions .duplicate-template:hover {
    color: #28a745;
    border-color: #28a745;
}

.template-actions .delete-template:hover {
    color: #dc3545;
    border-color: #dc3545;
}

.no-templates {
    text-align: center;
    padding: 40px;
    color: #6c757d;
}

.no-templates p {
    margin: 10px 0;
}
</style>